angular.module("ngTableResize",[]),angular.module("ngTableResize").directive("resizeable",["resizeStorage","$injector",function(t,e){function n(){}function o(t,e,n){S=e,D=t.container?$(t.container):$(S).parent(),$(S).addClass("resize"),l(S,n,t),r(S,n,t),s(S,n,t),u(S,n,t),i(S,n,t)}function i(t,e,n){n.$watch("profile",function(o,i){a(t),l(t,e,n)})}function r(t,e,n){void 0!==n.bind&&(n.bind={update:function(){a(t),l(t,e,n)}})}function u(t,e,n){n.$watch(function(){return $(t).find("th").length},function(){a(t),l(t,e,n)})}function s(t,e,n){n.$watch(function(){return n.mode},function(){a(t),l(t,e,n)})}function a(t){W=!0,c(t)}function c(t){$(t).find("th").find(".handle").remove()}function l(e,n,o){C=$(e).find("th"),w=o.mode,g=!angular.isDefined(o.saveTableSizes)||o.saveTableSizes,z=o.profile;var i=m(o,n);i&&(M=new i(e,C,D),g&&(x=t.loadTableSizes(e,o.mode,o.profile)),T=M.handles(C),R=M.ctrlColumns,M.setup(),y(x),T.each(function(t,n){d(e,n)}))}function d(t,e){var n=$("<div>",{"class":"handle"});$(e).prepend(n);var o=M.handleMiddleware(n,e);f(t,n,o)}function f(t,e,n){$(e).mousedown(function(t){W&&(M.onFirstDrag(n,e),M.onTableReady(),W=!1);var o={};M.intervene&&(o=M.intervene.selector(n),o.column=o,o.orgWidth=$(o).width()),t.preventDefault(),$(e).addClass("active"),$("body").addClass("table-resize");var i=t.clientX,r=$(n).width();$(window).mousemove(h(n,i,r,o)),$(window).one("mouseup",v(e))})}function h(t,e,n,o){return function(i){var r=i.clientX,u=r-e,s=M.calculate(n,u);if(!(s<p(t)||M.restrict(s,u))){if(M.intervene){var a=M.intervene.calculator(o.orgWidth,u);if(a<p(o.column))return;if(M.intervene.restrict(a,u))return;$(o.column).width(a)}$(t).width(s)}}}function p(t){return parseInt($(t).css("min-width"))||0}function m(t,n){try{var o=n.mode?t.mode:"BasicResizer",i=e.get(o);return i}catch(r){return console.error("The resizer "+t.mode+" was not found"),null}}function v(t){return function(){$(t).removeClass("active"),$(window).unbind("mousemove"),$("body").removeClass("table-resize"),M.onEndDrag(),b()}}function b(){g&&(x||(x={}),$(C).each(function(t,e){var n=angular.element(e).scope(),o=n.colName||$(e).attr("id");o&&(x[o]=M.saveAttr(e))}),t.saveTableSizes(S,w,z,x))}function y(t){t&&($(S).width("auto"),R.each(function(e,n){var o=angular.element(n).scope(),i=o.colName||$(n).attr("id"),r=t[i];$(n).css({width:r})}),M.onTableReady())}var w,g,z,C=null,R=null,T=null,S=null,D=null,M=null,W=!0,x=null;return{restrict:"A",link:o,controller:n,controllerAs:"rzctrl",scope:{mode:"=",profile:"=?",saveTableSizes:"=?",bind:"=",container:"@"}}}]),angular.module("ngTableResize").directive("resizeCol",[function(){function t(t,e,n){t.colName=t.$eval(n.resizeCol)}return{restrict:"A",link:t,require:"^^resizeable",scope:!0}}]),angular.module("ngTableResize").service("resizeStorage",["$window",function(t){function e(t,e,o){var i=t.attr("id");return i?n+"."+t.attr("id")+"."+e+(o?"."+o:""):void console.error("Table has no id",t)}var n="ngColumnResize";this.loadTableSizes=function(n,o,i){var r=e(n,o,i),u=t.localStorage.getItem(r);return JSON.parse(u)},this.saveTableSizes=function(n,o,i,r){var u=e(n,o,i);if(u){var s=JSON.stringify(r);t.localStorage.setItem(u,s)}}}]),angular.module("ngTableResize").factory("ResizerModel",[function(){function t(t,e,n){this.table=t,this.columns=e,this.container=n,this.handleColumns=this.handles(),this.ctrlColumns=this.ctrlColumns()}return t.prototype.setup=function(){$(this.container).css({overflowX:"hidden"})},t.prototype.onTableReady=function(){$(this.table).outerWidth("100%")},t.prototype.getMinWidth=function(t){return parseInt($(t).css("min-width"))||0},t.prototype.handles=function(){return this.columns},t.prototype.ctrlColumns=function(){return this.handleColumns},t.prototype.onFirstDrag=function(){$(this.ctrlColumns).each(function(t,e){$(e).width($(e).width())})},t.prototype.handleMiddleware=function(t,e){return e},t.prototype.restrict=function(t){return!1},t.prototype.calculate=function(t,e){return t+e},t.prototype.onEndDrag=function(){},t.prototype.saveAttr=function(t){return $(t).outerWidth()},t}]),angular.module("ngTableResize").factory("BasicResizer",["ResizerModel",function(t){function e(e,r,u){t.call(this,e,r,u),this.ctrlColumns=this.columns,this.intervene={selector:n,calculator:o,restrict:i}}function n(t){return $(t).next()}function o(t,e){return t-e}function i(t){return t<25}return e.prototype=Object.create(t.prototype),e.prototype.setup=function(){$(this.container).css({overflowX:"hidden"}),$(this.table).css({width:"100%"})},e.prototype.handles=function(){return $(this.columns).not(":last")},e.prototype.onFirstDrag=function(){this.onEndDrag()},e.prototype.onEndDrag=function(){var t=$(this.table).outerWidth(),e=[];$(this.columns).each(function(n,o){var i=$(o).outerWidth(),r=i/t*100+"%";e.push(function(){$(o).css({width:r})})}),e.map(function(t){t()})},e.prototype.saveAttr=function(t){return $(t)[0].style.width},e}]),angular.module("ngTableResize").factory("FixedResizer",["ResizerModel",function(t){function e(e,n,o){t.call(this,e,n,o),this.fixedColumn=$(e).find("th").first(),this.bound=!1}return e.prototype=Object.create(t.prototype),e.prototype.setup=function(){$(this.container).css({overflowX:"hidden"}),$(this.table).css({width:"100%"}),$(this.columns).first().css({width:"auto"})},e.prototype.handles=function(){return $(this.columns).not(":last")},e.prototype.ctrlColumns=function(){return $(this.columns).not(":first")},e.prototype.onFirstDrag=function(){$(this.ctrlColumns).each(function(t,e){$(e).width($(e).width())})},e.prototype.handleMiddleware=function(t,e){return $(e).next()},e.prototype.restrict=function(t,e){return this.bound&&this.bound<e?(this.bound=!1,!1):!!(this.bound&&this.bound>e)||(this.fixedColumn.width()<=this.getMinWidth(this.fixedColumn)?(this.bound=e,$(this.fixedColumn).width(this.minWidth),!0):void 0)},e.prototype.onEndDrag=function(){this.bound=!1},e.prototype.calculate=function(t,e){return t-e},e}]),angular.module("ngTableResize").factory("OverflowResizer",["ResizerModel",function(t){function e(e,n,o){t.call(this,e,n,o)}return e.prototype=Object.create(t.prototype),e.prototype.setup=function(){$(this.container).css({overflow:"auto"})},e.prototype.onTableReady=function(){$(this.table).width(1)},e}]);